24-08-2023

Q1.WAQTD NUMBER OF EMP, MAX SAL, MIN SAL OF EMP WORKING IN EACH DEPT IF EMP NAME STARTS WITH CHAR 'A' AND THEIR MAX SAL IS LESS THAN 5000 ORDER BY DEPTNO IN DESC ORDER.

SQL> SELECT COUNT(*), MAX(SAL), MIN(SAL), DEPTNO FROM EMP
  2  WHERE ENAME LIKE 'A%' GROUP BY DEPTNO HAVING MAX(SAL) < 50000
  3  ORDER BY DEPTNO DESC;

  COUNT(*)   MAX(SAL)   MIN(SAL)     DEPTNO
---------- ---------- ---------- ----------
         1       1600       1600         30
         1       1100       1100         20


Q2.WAQTD NAME OF EMP WHO IS GETTING A SALARY MORE THAN 1500.

SQL> SELECT ENAME FROM EMP WHERE SAL > 1500;

ENAME
----------
ALLEN
JONES
BLAKE
CLARK
SCOTT
KING
FORD

7 rows selected.

Q3. WAQTD NAME AND SAL OF EMP WHO IS GETTING A SALARY MORE THAN JONES.

SQL> SELECT ENAME, SAL FROM EMP WHERE SAL > ( SELECT SAL FROM EMP WHERE ENAME = 'JONES');

ENAME             SAL
---------- ----------
SCOTT            3000
KING             5000
FORD             3000

*) SUB-QUERY:
- A QUERY WRITTEN INSIDE ANOTHER QUERY IS KNOW AS SUB-QUERY.
- WORKING PRINCIPLE OF SUBQUERY:

    
      RESULT<----------OUTER QUERY
                           /|
                          / |DEPENDENT
                      I/P/  |
                        /   |
                       /   \/
                 OUTPUT<----INNERQUERY(SUBQUERY)


-)LETS CONSIDER TWO QUERIES 1.OUTER QUERY AND 2.INNER QUERY(SUBQUERY)
-IN SUBQUERY, ALWAYS INNERQUERY WILL EXECUTE FIRST AND PRODUCES THE OUTPUT.
-THE OUTPUT PRODUCE BY THE INNER QUERY WILL BE TAKEN AS AN INPUT TO THE OUTER QUERY.
-OUTER QUERY WILL EXECUTE COMPLETLY AND PRODUCE THE RESULT.
-THEREFORE, WE CAN SAY THAT OUTER QUERY IS TOTALLY DEPENDENT ON INNER QUERY.

-)WHY AND WHEN WE USE SUBQUERY:
1)WHENEVER THEIR IS A UNKNOWN VALUE PRESENT IN A QUESTION, TO FIND THAT UNKNOWN VALUE WE USE SUBQUERY.

Q1. WAQTD NAME OF EMP WHO IS GETTING A SAL LESS THAN MILLER.

SQL> SELECT ENAME, SAL FROM EMP WHERE SAL < ( SELECT SAL FROM EMP WHERE ENAME = 'MILLER');

ENAME             SAL
---------- ----------
SMITH             800
WARD             1250
MARTIN           1250
ADAMS            1100
JAMES             950


Q2. WAQTD NAME OF EMP WHO IS WORKING IN SAME DEPTNO AS MARTIN.

SQL> SELECT ENAME, DEPTNO FROM EMP WHERE DEPTNO = ( SELECT DEPTNO FROM EMP
  2  WHERE ENAME = 'MARTIN');

ENAME          DEPTNO
---------- ----------
ALLEN              30
WARD               30
MARTIN             30
BLAKE              30
TURNER             30
JAMES              30

6 rows selected.

Q3. WAQTD NAME AND JOB OF EMP WHO IS WORKING IN SAME DESGINATION AS ALLEN.

SQL> SELECT ENAME, JOB FROM EMP WHERE JOB = ( SELECT JOB FROM EMP WHERE
  2  ENAME = 'ALLEN');

ENAME      JOB
---------- ---------
ALLEN      SALESMAN
WARD       SALESMAN
MARTIN     SALESMAN
TURNER     SALESMAN

Q4. WAQTD NAME AND HIREDATE OF EMP WHO IS HIRED AFTER JAMES.

SQL> SELECT ENAME, HIREDATE FROM EMP WHERE HIREDATE > 
  2  (SELECT HIREDATE FROM EMP WHERE ENAME = 'JAMES');

ENAME      HIREDATE
---------- ---------
SCOTT      19-APR-87
ADAMS      23-MAY-87
MILLER     23-JAN-82

Q5. WAQTD NAME AND SLALARY OF EMP WHO IS GETTING A SAL MORE THAN 2000 AND WORKING IN SAME DESGINATION AS BLAKE.

SQL> SELECT ENAME, JOB, SAL FROM EMP
  2  WHERE JOB = (SELECT JOB FROM EMP
  3  WHERE ENAME = 'BLAKE' AND SAL > 2000);

ENAME      JOB              SAL
---------- --------- ----------
JONES      MANAGER         2975
BLAKE      MANAGER         2850
CLARK      MANAGER         2450

Q6. WAQTD DETAILS OF EMP WHOSE NAME STARTS WITH 'M' AND GETTING A SALARY LESS THAN JONES.

SQL> SELECT * FROM EMP
  2  WHERE ENAME LIKE 'M%' AND SAL < 
  3  (SELECT SAL FROM EMP
  4  WHERE ENAME = JONES);
WHERE ENAME = JONES)
              *
ERROR at line 4:
ORA-00904: "JONES": invalid identifier


SQL> ED
Wrote file afiedt.buf

  1  SELECT * FROM EMP
  2  WHERE ENAME LIKE 'M%' AND SAL <
  3  (SELECT SAL FROM EMP
  4* WHERE ENAME = 'JONES')
SQL> /

     EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM     DEPTNO
---------- ---------- --------- ---------- --------- ---------- ---------- ----------
      7654 MARTIN     SALESMAN        7698 28-SEP-81       1250       1400         30
      7934 MILLER     CLERK           7782 23-JAN-82       1300                    10


Q7. WAQTD NAME AND SAL OF EMP WHO IS GETTING A SAL MORE THAN SMITH BUT LESS THAN KING.

SQL> SELECT ENAME, SAL FROM EMP 
  2  WHERE SAL > (SELECT SAL FROM EMP
  3  WHERE ENAME = 'SMITH') AND SAL < (SELECT
  4  SAL FROM EMP WHERE ENAME = 'KING');

ENAME             SAL
---------- ----------
ALLEN            1600
WARD             1250
JONES            2975
MARTIN           1250
BLAKE            2850
CLARK            2450
SCOTT            3000
TURNER           1500
ADAMS            1100
JAMES             950
FORD             3000
MILLER           1300

12 rows selected.

Q8. WAQTD DETAIL OF EMP WHO IS WORKING AS MANAGER AND GETTING A SAL MORE THAN JONES AND HIRED AFTER KING.

SQL> SELECT * FROM EMP
  2  WHERE JOB = 'MANAGER'
  3  AND SAL > (SELECT SAL FROM EMP WHERE
  4  ENAME = 'JONES') AND HIREDATE > (SELECT HIREDATE 
  5  FROM EMP WHERE ENAME = 'KING');

no rows selected

Q9. WAQTD NAME OF EMP WHO IS WORKING IN SAME DEPTNO AS JAMES AND GETTING A SAL MORE THAN ADAMS AND WORKING IN SAME DESGINATION AS MILLER AND HIRED AFTER MARTIN.

SQL> SELECT ENAME FROM EMP
  2  WHERE DEPTNO = ( SELECT DEPTNO FROM EMP
  3  WHERE ENAME = 'JAMES') 
  4  AND SAL > ( SELECT SAL FROM EMP 
  5  WHERE ENAME = 'ADAMS') 
  6  AND JOB = ( SELECT JOB FROM EMP
  7  WHERE ENAME = 'MILLER')
  8  AND HIREDATE > (SELECT HIREDATE FROM EMP
  9  WHERE ENAME = 'MARTIN');

no rows selected

Q10. WAQTD DETAILS OF EMP WORKING AS A MANAGER.

SQL> SELECT * FROM EMP WHERE JOB = 'MANAGER';

     EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM     DEPTNO
---------- ---------- --------- ---------- --------- ---------- ---------- ----------
      7566 JONES      MANAGER         7839 02-APR-81       2975                    20
      7698 BLAKE      MANAGER         7839 01-MAY-81       2850                    30
      7782 CLARK      MANAGER         7839 09-JUN-81       2450                    10



































































































































