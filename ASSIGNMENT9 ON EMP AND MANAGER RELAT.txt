ASSIGNMENT ON EMP AND MANAGER RELATION.

1.WAQTD SCOTT'S REPORTING MANAGER'S NAME

SQL> SELECT ENAME FROM EMP
  2  WHERE EMPNO =
  3  (SELECT MGR FROM EMP
  4  WHERE ENAME = 'SCOTT');

ENAME
----------
JONES

2.WAQTD ADAMS MANAGER'S MANAGER NAME

SQL>  SELECT ENAME FROM EMP
  2   WHERE EMPNO =
  3   (SELECT MGR FROM EMP
  4   WHERE EMPNO =
  5   (SELECT MGR FROM EMP
  6   WHERE ENAME = 'ADAMS'));

ENAME
----------
JONES


3.WAQTD DNAME OF JONES MANAGER

SQL> SELECT DNAME FROM DEPT
  2  WHERE DEPTNO =
  3  (SELECT DEPTNO FROM EMP
  4  WHERE EMPNO =
  5  (SELECT MGR FROM EMP
  6  WHERE ENAME = 'JONES'));

DNAME
--------------
ACCOUNTING


4.WAQTD MILLER'S MANAGER'S SALARY

SQL> SELECT SAL FROM EMP
  2  WHERE EMPNO =
  3  (SELECT MGR FROM EMP
  4  WHERE ENAME = 'MILLER');

       SAL
----------
      2450

5.WAQTD LOC OF SMITH'S MANAGER'S MANAGER.

SQL> SELECT LOC FROM DEPT
  2  WHERE DEPTNO =
  3  (SELECT DEPTNO FROM EMP
  4  WHERE EMPNO =
  5  (SELECT MGR FROM EMP
  6  WHERE EMPNO =
  7  (SELECT MGR FROM EMP
  8  WHERE ENAME = 'SMITH')));

LOC
-------------
DALLAS

6.WAQTD NAME OF THE EMPLOYEES REPORTING TO BLAKE

SQL> SELECT ENAME FROM EMP
  2  WHERE MGR =
  3  (SELECT EMPNO FROM EMP
  4  WHERE ENAME = 'BLAKE');

ENAME
----------
ALLEN
WARD
MARTIN
TURNER
JAMES

7.WAQTD NUMBER OF EMPLPOYEES REPORTING TO KING

SQL> SELECT COUNT(*) FROM EMP
  2  WHERE MGR =
  3  (SELECT EMPNO FROM EMP
  4  WHERE ENAME = 'KING');

  COUNT(*)
----------
         3

8.WAQTD DETAILS OF THE EMPLOYEES REPORTING TO JONES.

SQL> SELECT * FROM EMP
  2  WHERE MGR =
  3  (SELECT EMPNO FROM EMP
  4  WHERE ENAME = 'JONES');

     EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM     DEPTNO
---------- ---------- --------- ---------- --------- ---------- ---------- ----------
      7788 SCOTT      ANALYST         7566 19-APR-87       3000                    20
      7902 FORD       ANALYST         7566 03-DEC-81       3000                    20

9.WAQTD ENAMES OF THE EMPLOYEES REPORTING TO BLAKE'S MANAGER

SQL> SELECT ENAME FROM EMP
  2  WHERE MGR =
  3  (SELECT EMPNO FROM EMP
  4   WHERE EMPNO =
  5   (SELECT MGR FROM EMP
  6   WHERE ENAME = 'BLAKE'));

ENAME
----------
JONES
BLAKE
CLARK

10. WAQTD NUMBER OF EMPLOYEES REPORTING TO FORD'S MANAGER.

SQL> SELECT ENAME FROM EMP
  2  WHERE MGR =
  3  (SELECT EMPNO FROM EMP
  4   WHERE EMPNO =
  5   (SELECT MGR FROM EMP
  6   WHERE ENAME = 'FORD'));

ENAME
----------
SCOTT
FORD

11) WAQTD dname of the employee reporting to President.

SQL> SELECT * FROM DEPT
  2  WHERE DEPTNO IN
  3  (SELECT DEPTNO FROM EMP
  4  WHERE MGR =
  5  (SELECT EMPNO FROM EMP
  6  WHERE JOB = 'PRESIDENT'));

    DEPTNO DNAME          LOC
---------- -------------- -------------
        30 SALES          CHICAGO
        20 RESEARCH       DALLAS
        10 ACCOUNTING     NEW YORK

12) WAQTD Department details of the employees who are reporting to MILLER.

SQL> SELECT * FROM DEPT
  2  WHERE DEPTNO =
  3  (SELECT DEPTNO FROM EMP
  4  WHERE MGR =
  5  (SELECT EMPNO FROM EMP
  6  WHERE ENAME = 'MILLER'));

no rows selected

13) WAQTD Location of Adams's manager's manager. 

SQL> SELECT LOC FROM DEPT
  2  WHERE DEPTNO =
  3  (SELECT DEPTNO FROM EMP
  4  WHERE EMPNO =
  5  (SELECT MGR FROM EMP
  6  WHERE EMPNO =
  7  (SELECT MGR FROM EMP
  8  WHERE ENAME = 'ADAMS')));

LOC
-------------
DALLAS

14) WAQTD dname of King's Manager.

SQL> SELECT DNAME FROM DEPT
  2  WHERE DEPTNO =
  3  (SELECT DEPTNO FROM EMP
  4  WHERE EMPNO =
  5  (SELECT MGR FROM EMP
  6  WHERE ENAME = 'KING'));

no rows selected

15) WAQTD Name and salary given to the employees reporting To James 

SQL> SELECT ENAME, SAL FROM EMP
  2  WHERE MGR =
  3  (SELECT EMPNO FROM EMP
  4  WHERE ENAME = 'JAMES');

no rows selected

ASSIGNMENT ON NESTED SUB QUERY:

1.WAQTD 2ND MINIMUM SALARY.

SQL> SELECT MIN(SAL) FROM EMP
  2  WHERE SAL >
  3  (SELECT MIN(SAL) FROM EMP);

  MIN(SAL)
----------
       950

2.WAQTD 5TH MAXIMUM SALARY.

SQL> SELECT MAX(SAL) FROM EMP
  2  WHERE SAL <
  3  (SELECT MAX(SAL) FROM EMP
  4  WHERE SAL <
  5  (SELECT MAX(SAL) FROM EMP
  6  WHERE SAL <
  7  (SELECT MAX(SAL) FROM EMP
  8  WHERE SAL <
  9  (SELECT MAX(SAL) FROM EMP))));

  MAX(SAL)
----------
      2450


3.WAQTD NAME OF THE EMPLOYEE EARNING 3RD MAXIMUM SALARY.

SQL> SELECT DISTINCT SAL, ENAME
  2  FROM EMP E
  3  WHERE (SELECT COUNT(DISTINCT SAL)
  4  FROM EMP M
  5  WHERE E.SAL < M.SAL) IN(2);

       SAL ENAME
---------- ----------
      2975 JONES


4.WAQTD EMPNO OF THE EMPLOYEE EARNING 2ND MAXIMUM SALARY

SQL> SELECT DISTINCT SAL, EMPNO
  2  FROM EMP E
  3  WHERE (SELECT COUNT(DISTINCT SAL)
  4  FROM EMP M
  5  WHERE E.SAL < M.SAL) IN(1);

       SAL      EMPNO
---------- ----------
      3000       7788
      3000       7902


5.WAQTD DEPARTMENT NAME OF AN EMPLOYEE GETTING 4TH MAX SAL

6.WAQTD DETAILS OF THE EMPLOYEE WHO WAS HIRED 2nd 
7.WAQTD NAME OF THE EMPLOYEE HIRED BEFORE THE LAST EMPLOYEE

8. WAQTD LOC OF THE EMPLOYEE WHO WAS HIRED FIRST

9. WAQTD DETAILS OF THE EMPLOYEE EARNING 7TH MINIMUM SALARY 

10. WAQTD DNAME OF EMPLOYEE GETTING 2ND MAXIMUM SALARY